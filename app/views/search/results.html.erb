<% content_for(:sidenav) do %>
  <%= render :partial => 'search_side_nav' %>
<% end %>

<% content_for(:breadcrumbs) do %>
	Search: <%= @term %>
<% end %>

<% content_for :js do %>
  $("#studies-link").click(function() {
    $('#study-results').show();
    $('#study-facets').show();
    $('#variable-results').hide();
    $('#variable-facets').hide();
  	$('#study-items').toggleClass('selected-tab', true);
  	$('#variable-items').toggleClass('selected-tab', false);
  });

  $("#variables-link").click(function() {
    $('#variable-results').show();
    $('#variable-facets').show();
    $('#study-results').hide();
    $('#study-facets').hide();
  	$('#study-items').toggleClass('selected-tab', false);
  	$('#variable-items').toggleClass('selected-tab', true);
  });
<% end %>

<div id="search-results">

	Term: <%= params[:term] %> <p/>
	
	<% if params[:filters].any? %>
	Filters:
	
		<% params[:filters].each do |facet|
		  facet.each do |name, value| %>
			<%= Study::FACETS[name.to_sym] %> = <%= value %>
			<% unless facet == params[:filters].last %>, <% end %>
			<% end %>
		<% end %>
	<% end %>
	
	<% if params[:var_filters].any? %>
		Variable Filters:
	
		<% params[:var_filters].each do |facet|
		  facet.each do |name, value| %>
			<%= name %> = <%= value %>
			<% unless facet == params[:var_filters].last %>, <% end %>
			<% end %>
		<% end %>
	<% end %>

	<div id="search-tabs">
	  <ul>
	    <li id="study-items" class="selected-tab"> <a id="studies-link">Studies</a> </li>
	    <li id="variable-items"> <a id="variables-link">Variables</a> </li>
	  </ul>
	</div>

	<%= render(:partial => "studies") %>
	<%= render(:partial => "variables") %>
</div>
