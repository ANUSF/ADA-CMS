/*Explr v1.3 - Copyright 2011 amatyr4n http://codecanyon.net/user/amatyr4n - licensed under Envato licenses http://wiki.envato.com/support/legal-terms/licensing-terms/*/(function($){$.fn.explrTree=function(options){var defaults={ajaxContainerId:'explr-content',ajaxLoadingText:'<p>loading..</p>',ajaxOptions:{},animDuration:'fast',folderTooltip:'click to expand/collapse',rememberState:true,startCollapsed:true,treeHeight:'auto',treeWidth:'auto'};var opts=$.extend(defaults,options);function getState($uls){return $uls.map(function(){if($(this).is(':hidden')){return 0;}else{return 1;}}).get().join(',');}function explrCookie(p,id,arr){if(opts.rememberState){if(p==='set'){document.cookie='explr-'+id+'='+escape(arr);}else{var dc=document.cookie;var index=dc.indexOf('explr-'+id+'=');if(index>=0){if(p==='check'){return true;}var start=index+id.length+7;var end=dc.indexOf(';',start);if(start!==id.length){if(end===-1){end=dc.length;}return unescape(dc.substring(start,end));}}return false;}}return false;}return this.each(function(){var $tree=$(this);var treeId=$tree.attr('id');$tree.addClass('explr-tree').css({'height':opts.treeHeight,'width':opts.treeWidth}).find('li:not(:last-child) > ul').addClass('explr-line-fix').end().find('li').prepend('<span class="explr-line"></span>').not(':has(ul)').addClass('icon-text').end().has('ul').prepend('<span class="explr-plus" title="'+opts.folderTooltip+'"></span>').delegate('.explr-plus, a[href="#"]','click',function(e){$(this).siblings('ul').slideToggle(opts.animDuration,function(){explrCookie('set',treeId,getState($tree.find('ul')));}).siblings('.explr-plus').toggleClass('explr-minus');return false;});$tree.delegate('a[rel*="explr-ajax"]','click',function(){$('#'+opts.ajaxContainerId).html(opts.ajaxLoadingText);var ajaxDefault={dataType:'html',url:$(this).attr('href'),error:function(xhr){$('#'+opts.ajaxContainerId).html(xhr.statusText+' '+xhr.status);},success:function(data){$('#'+opts.ajaxContainerId).html(data);}};$.ajax($.extend(ajaxDefault,opts.ajaxOptions));return false;});if(explrCookie('check',treeId)){var uls=explrCookie('get',treeId).split(',');var ulIndex=0;$tree.find('ul').each(function(){if(parseInt(uls[ulIndex],10)){$(this).siblings('.explr-plus').addClass('explr-minus');}else{$(this).hide();}ulIndex+=1;});}else if(opts.startCollapsed){$tree.find('ul').hide().end().find('.explr-expand').show().siblings('.explr-plus').addClass('explr-minus');}else{$tree.find('.explr-collapse').hide().end().find('ul:not(.explr-collapse)').siblings('.explr-plus').addClass('explr-minus');}if($.browser.msie){$tree.addClass('explr-ie');}});};}(jQuery));
